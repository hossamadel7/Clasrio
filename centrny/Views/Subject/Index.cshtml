@using SubjectResource = centrny.Resources.Subject
@{
    ViewBag.Title = SubjectResource.Subject_ListTitle;
}
<link rel="stylesheet" href="~/css/Hamody.css" />

<h2>@SubjectResource.Subject_ListTitle</h2>
<!-- DEBUG: Direct resource output -->
<div style="color:red; font-weight:bold; margin:10px 0;">
    @centrny.Resources.Subject.Subject_AddModalTitle
</div>

<!-- Add Subject Button -->
<div style="margin-bottom: 22px;">
    <button id="add-subject-btn" class="modern-btn">@SubjectResource.Subject_AddBtn</button>
</div>

<!-- Modal for Add/Edit Subject -->
<div id="addSubjectModal" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <div class="modal-header">
            <span id="modalTitle" style="font-weight:600;font-size:1.15rem;">@SubjectResource.Subject_AddModalTitle</span>
            <span id="closeModal" style="cursor:pointer;font-size:1.4rem;">&times;</span>
        </div>
        <form id="addSubjectForm">
            <input type="hidden" id="subjectCode" name="subjectCode" />
            <div class="form-group">
                <label for="subjectName">@SubjectResource.Subject_NameLabel</label>
                <input type="text" id="subjectName" name="subjectName" required maxlength="100" />
            </div>
            <div class="form-group">
                <label for="isPrimary">@SubjectResource.Subject_IsPrimaryLabel</label>
                <select id="isPrimary" name="isPrimary" required>
                    <option value="true">@SubjectResource.Subject_Yes</option>
                    <option value="false">@SubjectResource.Subject_No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="yearCode">@SubjectResource.Subject_YearLabel</label>
                <select id="yearCode" name="yearCode" required>
                    <option value="">@SubjectResource.Subject_LoadingYears</option>
                </select>
            </div>
            <div id="addSubjectError" style="color:#c00; margin-bottom:10px;"></div>
            <button type="submit" class="modern-btn" style="width:100%;">@SubjectResource.Subject_Submit</button>
        </form>
    </div>
</div>

<!-- Modal for Add Teacher to Subject -->
<div id="addTeacherToSubjectModal" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <div class="modal-header">
            <span style="font-weight:600;font-size:1.15rem;">@SubjectResource.Subject_AssignTeacherToSubjectTitle</span>
            <span id="closeAddTeacherToSubjectModal" style="cursor:pointer;font-size:1.4rem;">&times;</span>
        </div>
        <form id="addTeacherToSubjectForm">
            <div class="form-group">
                <label>@SubjectResource.Subject_NameLabel</label>
                <input type="text" id="addTeacherSubjectName" readonly />
            </div>
            <div class="form-group">
                <label>@SubjectResource.Subject_TeacherLabel</label>
                <select id="addTeacherTeacherCode" required></select>
            </div>
            <div class="form-group">
                <label>@SubjectResource.Subject_BranchLabel</label>
                <select id="addTeacherBranchCode" required></select>
            </div>
            <div class="form-group">
                <label>@SubjectResource.Subject_CenterPercentageLabel</label>
                <input type="number" step="0.01" id="addTeacherCenterPercentage" />
            </div>
            <div class="form-group">
                <label>@SubjectResource.Subject_CenterAmountLabel</label>
                <input type="number" step="0.01" id="addTeacherCenterAmount" />
            </div>
            <input type="hidden" id="addTeacherYearCode" />
            <input type="hidden" id="addTeacherEduYearCode" />
            <button type="submit" class="modern-btn" style="width:100%;">@SubjectResource.Subject_AssignTeacher</button>
        </form>
    </div>
</div>

<div class="subject-table-container">
    <table>
        <thead>
            <tr>
                <th>@SubjectResource.Subject_NameLabel</th>
                <th>@SubjectResource.Subject_IsPrimary</th>
                <th>@SubjectResource.Subject_YearName</th>
                <th>@SubjectResource.Subject_Actions</th>
            </tr>
        </thead>
        <tbody id="subject-body">
            <!-- JS will populate this, including show/hide teacher rows -->
        </tbody>
    </table>
    <div id="subject-message" style="margin-top:20px;color:#b33c3c;font-weight:600;"></div>
</div>

@section Scripts {
    <script>
        // Localized JS variables
        const editTitle = '@SubjectResource.Subject_EditModalTitle';
        const addTitle = '@SubjectResource.Subject_AddModalTitle';
        const yesText = '@SubjectResource.Subject_Yes';
        const noText = '@SubjectResource.Subject_No';
        const loadingYearsText = '@SubjectResource.Subject_LoadingYears';
        const noActiveYearsText = '@SubjectResource.Subject_NoActiveYears';
        const errorLoadingYearsText = '@SubjectResource.Subject_ErrorLoadingYears';
        const pleaseFillFieldsText = '@SubjectResource.Subject_PleaseFillFields';
        const couldNotAddText = '@SubjectResource.Subject_CouldNotAdd';
        const couldNotEditText = '@SubjectResource.Subject_CouldNotEdit';
        const couldNotDeleteText = '@SubjectResource.Subject_CouldNotDelete';
        const deleteConfirmText = '@SubjectResource.Subject_DeleteConfirm';
        const unauthorizedText = '@SubjectResource.Subject_Unauthorized';
        const notFoundText = '@SubjectResource.Subject_NotFound';
        const noSubjectsText = '@SubjectResource.Subject_NoSubjects';
        const errorLoadingText = '@SubjectResource.Subject_ErrorLoading';
        const closeText = '@SubjectResource.Subject_Close';
        const assignTeacherText = '@SubjectResource.Subject_AssignTeacher';
        const processingText = '@SubjectResource.Subject_Processing';
        const addTeacherText = '@SubjectResource.Subject_AddTeacher';
        const showTeachersText = '@SubjectResource.Subject_ShowTeachers';
        const couldNotAssignTeacherText = '@SubjectResource.Subject_CouldNotAssignTeacher';
        const noTeachersAssignedText = '@SubjectResource.Subject_NoTeachersAssigned';
    </script>
    <script src="~/js/SubjectManagement.js"></script>
}